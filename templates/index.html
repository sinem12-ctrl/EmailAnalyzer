<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Mail Ã‡ekici</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2285%22>ğŸ“§</text></svg>">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>
<body>
  <h2>ğŸ“§ Mail Ã‡ekici</h2>

  <!-- YÃ¼kleniyor animasyonu (Ã¼stte) -->
  <div id="loading" class="loading hidden">
    <div></div><div></div><div></div>
  </div>

  <!-- Flash mesajlar -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% for category, message in messages %}
      <div class="{{ category }}">{{ message }}</div>
    {% endfor %}
  {% endwith %}

  <form method="POST" id="mailForm">
    <label for="email">ğŸ“¨ E-posta Adresi:</label>
    <input type="email" name="email" id="email" required />

    <label for="sifre">ğŸ”‘ Uygulama Åifresi:</label>
    <input type="password" name="sifre" id="sifre" required />

    <!-- Mail TÃ¼rÃ¼ -->
    <label>ğŸ“‚ Mail TÃ¼rÃ¼ (birden fazla seÃ§ebilirsiniz):</label>
    <div id="veri_turu_checkboxes">
      <label><input type="checkbox" name="veri_turu" value="ham" /> Ham Mail</label>
      <label><input type="checkbox" name="veri_turu" value="temiz" /> TemizlenmiÅŸ Mail</label>
      <label><input type="checkbox" name="veri_turu" value="spam" /> Spam ve Sistem MesajlarÄ±</label>
    </div>

    <!-- Format -->
    <label>ğŸ’¾ Format (birden fazla seÃ§ebilirsiniz):</label>
    <div id="format_checkboxes">
      <label><input type="checkbox" name="format" value="json" /> JSON</label>
      <label><input type="checkbox" name="format" value="csv" /> CSV</label>
    </div>

    <!-- Tarih Filtresi -->
    <label for="tarih_tipi">ğŸ“… Tarih Filtresi:</label>
    <select name="tarih_tipi" id="tarih_tipi" onchange="gosterAlan()">
      <option value="">SeÃ§</option>
      <option value="tek">ğŸ“… Åu tarihten itibaren</option>
      <option value="aralik">ğŸ“† Ä°ki tarih arasÄ±</option>
    </select>

    <!-- Tek tarih -->
    <div id="tek_tarih" class="hidden">
      <label for="tek_tarih_input">BaÅŸlangÄ±Ã§ Tarihi:</label>
      <input type="date" name="tek_tarih" id="tek_tarih_input" />
    </div>

    <!-- Tarih aralÄ±ÄŸÄ± -->
    <div id="tarih_aralik" class="hidden">
      <label for="aralik_baslangic">BaÅŸlangÄ±Ã§ Tarihi:</label>
      <input type="date" name="aralik_baslangic" id="aralik_baslangic" />
      <label for="tarih_bitis">BitiÅŸ Tarihi:</label>
      <input type="date" name="tarih_bitis" id="tarih_bitis" />
    </div>

    <!-- Grafik seÃ§imi -->
    <label for="grafik_kaydet">ğŸ“Š Grafik Kaydedilsin mi?</label>
    <select name="grafik_kaydet" id="grafik_kaydet" required>
      <option value="evet" selected>Evet</option>
      <option value="hayir">HayÄ±r</option>
    </select>

    <button type="submit">ğŸ“¥ Mailleri Ã‡ek</button>
  </form>

  <!-- YÃ¼kleniyor animasyonu (formun altÄ±nda da gÃ¶sterilsin) -->
  <div id="loading-bottom" class="loading hidden">
    <div></div><div></div><div></div>
  </div>

<script>
  // Tarih tipi seÃ§imine gÃ¶re alanlarÄ± gÃ¶ster/gizle
  function gosterAlan() {
    const val = document.getElementById("tarih_tipi").value;
    document.getElementById("tek_tarih").style.display = val === "tek" ? "block" : "none";
    document.getElementById("tarih_aralik").style.display = val === "aralik" ? "block" : "none";
  }

  // Sayfa yÃ¼klendiÄŸinde alanlarÄ± kontrol et
  window.addEventListener("DOMContentLoaded", () => {
    gosterAlan();
  });

  // Form gÃ¶nderilince loading gÃ¶ster
  document.getElementById("mailForm").addEventListener("submit", () => {
    const loadingTop = document.getElementById('loading');
    const loadingBottom = document.getElementById('loading-bottom');
    if (loadingTop) loadingTop.classList.remove('hidden');
    if (loadingBottom) loadingBottom.classList.remove('hidden');
  });
</script>
</body>
</html>